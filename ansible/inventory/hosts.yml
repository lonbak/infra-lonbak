# Ansible Inventory for Lonbak Infrastructure
# Update IPs to match your terraform.tfvars

all:
  children:
    # Proxmox host
    proxmox:
      hosts:
        anton:
          ansible_host: 192.168.0.10
          ansible_user: root

    # Core infrastructure (LXC containers)
    infrastructure:
      children:
        pihole:
          hosts:
            pihole:
              ansible_host: 192.168.0.11
              ansible_user: root

    # K3s cluster (LXC container - uses root)
    k3s:
      hosts:
        k3s-node:
          ansible_host: 192.168.0.12
          ansible_user: root

  vars:
    # Network configuration
    # LAN: 192.168.0.0/23 - Infrastructure in .0.x, DHCP clients in .1.x
    base_domain: lonbak.local
    network_gateway: 192.168.0.1
    network_cidr: "23"
    network_mask: "255.255.254.0"

    # DHCP configuration (managed by Omada)
    dhcp_range_start: 192.168.1.10
    dhcp_range_end: 192.168.1.199

    # Infrastructure IPs (static)
    proxmox_ip: 192.168.0.10
    pihole_ip: 192.168.0.11
    k3s_ip: 192.168.0.12

    # DNS settings
    upstream_dns_1: "1.1.1.1"
    upstream_dns_2: "8.8.8.8"

    # Local DNS entries (hostname: IP)
    # Note: Wildcard *.lonbak.local is also configured in dnsmasq
    local_dns_entries:
      - { name: "omada.{{ base_domain }}", ip: "{{ k3s_ip }}" }
      - { name: "traefik.{{ base_domain }}", ip: "{{ k3s_ip }}" }
      - { name: "k3s.{{ base_domain }}", ip: "{{ k3s_ip }}" }
      - { name: "status.{{ base_domain }}", ip: "{{ k3s_ip }}" }
      - { name: "pihole.{{ base_domain }}", ip: "{{ pihole_ip }}" }
      - { name: "pve.{{ base_domain }}", ip: "{{ proxmox_ip }}" }
      - { name: "proxmox.{{ base_domain }}", ip: "{{ proxmox_ip }}" }
      - { name: "registry.{{ base_domain }}", ip: "{{ k3s_ip }}" }

    # Pi-hole admin password (override in vault.yml or command line)
    pihole_admin_password: "admin123"

    # K3s settings
    k3s_version: "v1.31.4+k3s1"
